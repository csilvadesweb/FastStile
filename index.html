<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>FastStile Enterprise</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial;
  background:#eef2f6;
  color:#1f2937
}
header{
  background:linear-gradient(135deg,#0b2c3d,#133e55);
  color:#fff;
  padding:20px;
  font-size:22px;
  font-weight:800
}
.container{
  max-width:720px;
  margin:auto;
  padding:16px
}
.card{
  background:#fff;
  border-radius:16px;
  padding:18px;
  margin-bottom:14px;
  box-shadow:0 12px 30px rgba(0,0,0,.08)
}
.card h3{
  margin:0 0 6px;
  font-size:15px;
  font-weight:700;
  color:#475569
}
.value{
  font-size:24px;
  font-weight:900
}
.btn{
  width:100%;
  border:none;
  padding:14px;
  border-radius:12px;
  font-size:15px;
  font-weight:800;
  margin-top:8px;
  cursor:pointer
}
.primary{background:#0b2c3d;color:#fff}
.secondary{background:#e5e7eb}
.footer{
  text-align:center;
  font-size:12px;
  color:#64748b;
  margin:20px 0
}
</style>
</head>

<body>

<header>FastStile â€¢ Enterprise</header>

<div class="container">

  <div class="card">
    <h3>Receitas</h3>
    <div class="value" id="receitas">R$ 0,00</div>
  </div>

  <div class="card">
    <h3>Despesas</h3>
    <div class="value" id="despesas">R$ 0,00</div>
  </div>

  <div class="card">
    <h3>Saldo Atual</h3>
    <div class="value" id="saldo">R$ 0,00</div>
  </div>

  <button class="btn primary" onclick="gerarPDF()">ðŸ“„ RelatÃ³rio PDF Enterprise</button>
  <button class="btn secondary" onclick="backup()">ðŸ’¾ Backup</button>
  <button class="btn secondary" onclick="importar()">ðŸ“¥ Importar</button>
  <button class="btn secondary" onclick="resetar()">â™» Resetar</button>

  <input type="file" id="fileInput" hidden>

</div>

<div class="footer">
  Documento financeiro oficial â€¢ FastStile Â© 2026
</div>

<script>
const STORAGE_KEY="faststile_data";

function carregar(){
  const d=JSON.parse(localStorage.getItem(STORAGE_KEY))||{receitas:0,despesas:0};
  atualizar(d);
}

function atualizar(d){
  receitas.innerText=formatar(d.receitas);
  despesas.innerText=formatar(d.despesas);
  saldo.innerText=formatar(d.receitas-d.despesas);
}

function formatar(v){
  return v.toLocaleString("pt-BR",{style:"currency",currency:"BRL"});
}

function gerarPDF(){
  const {jsPDF}=window.jspdf;
  const doc=new jsPDF("p","mm","a4");

  const d=JSON.parse(localStorage.getItem(STORAGE_KEY))||{receitas:0,despesas:0};
  const saldo=d.receitas-d.despesas;
  const id=crypto.randomUUID().slice(0,12).toUpperCase();

  doc.setFont("helvetica","bold");
  doc.setFontSize(22);
  doc.text("FastStile",20,22);

  doc.setFontSize(12);
  doc.text("RelatÃ³rio Financeiro Enterprise",20,30);

  doc.line(20,34,190,34);

  doc.setFont("helvetica","normal");
  doc.text(`Emitido em: ${new Date().toLocaleString("pt-BR")}`,20,42);

  doc.setFontSize(14);
  doc.text(`Receitas: ${formatar(d.receitas)}`,20,62);
  doc.text(`Despesas: ${formatar(d.despesas)}`,20,74);

  doc.setFont("helvetica","bold");
  doc.text(`Saldo: ${formatar(saldo)}`,20,90);

  // GrÃ¡fico vetorial simples
  doc.setDrawColor(11,44,61);
  doc.rect(20,105,150,40);

  const max=Math.max(d.receitas,d.despesas,1);
  const rBar=(d.receitas/max)*120;
  const dBar=(d.despesas/max)*120;

  doc.setFillColor(11,44,61);
  doc.rect(25,130-rBar/4,40,rBar/4,"F");

  doc.setFillColor(150,0,0);
  doc.rect(85,130-dBar/4,40,dBar/4,"F");

  doc.setFontSize(10);
  doc.text("Receitas",30,138);
  doc.text("Despesas",90,138);

  doc.setFont("helvetica","italic");
  doc.text("Assinado digitalmente por FastStile Finance",20,265);

  doc.setFont("helvetica","normal");
  doc.text(`ID do Documento: ${id}`,20,272);

  doc.save(`FastStile-${id}.pdf`);
}

function backup(){
  const blob=new Blob([localStorage.getItem(STORAGE_KEY)],{type:"application/json"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="faststile-backup.json";
  a.click();
}

function importar(){
  fileInput.click();
  fileInput.onchange=e=>{
    const r=new FileReader();
    r.onload=()=>{
      localStorage.setItem(STORAGE_KEY,r.result);
      carregar();
      alert("Backup importado com sucesso!");
    };
    r.readAsText(e.target.files[0]);
  };
}

function resetar(){
  if(confirm("Deseja apagar todos os dados?")){
    localStorage.removeItem(STORAGE_KEY);
    carregar();
  }
}

carregar();
</script>

</body>
</html>